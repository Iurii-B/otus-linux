

#Домашнее задание 20

- Добавлен inet2Router, его видимость с хоста обспечена конструкцией Vagrant "public_network", когда организуется bridge с физическим сетевым адаптером хоста.
Через этот роутер при помощи статического NAT доступен сервер nginx, который поднят на centralServer. Т.к. используется public_network, то с хоста нужно обращаться не на localhost, а на "публичный" адрес inet2Router, который в моей сети 192.168.1.122

- С пробросом портов никаких сложностей нет, также как и с добавлением роутера. Основной комментарий к данному ДЗ - я полностью переписал Vagrantfile относительно исходного, предоставленного Otus. В синтаксисе от Otus некоторые места мне были непонятны, при этом в документации самого Vagrant, а также на github/stackoverflow примеры данный синтаксис не используют. Поэтому убрал конструкцию MACHINES = {} в начале файла, вся конфигурация выполняется через конструкцию Vagrant.configure("2") do |config|, как в примерах разработчика Vagrant. Также отказался от циклов (для меня было ненаглядно), причем в процессе удалось решить еще некоторые имевшиеся проблемы, в частности, многократные вызовы некоторых методов. Для этого указываю имена виртуальных машин в названии методов:
config.vm.define "inetRouter" do |inetRouter| 
	config.vm.box="centos/7" 
	inetRouter.vm.hostname="inetRouter" 
	........ 
	inetRouter.vm.provision "shell", inline: <<-SHELL

- Также стал запускать Vagrant на отдельном физическом хосте с Lubuntu - стало работать нормально, в отличие от запуска в Windows.

- Согласно требованию ДЗ, сделал knocking port как в инструкции по ссылке. Единственное, сделал его в простейшем варианте, когда стучимся только по 1 порту. Сделал так, чтобы сохранить управление по SSH через Vagrant (сеть 10.0.0.0/8). 

- Вопрос - как правильно сохранять результаты конфигурирования iptables? "iptables-save > /etc/sysconfig/iptables", "iptables-save >> /etc/sysconfig/iptables" или как-то иначе. Может вообще правильнее вручную редактировать файл iptables?
Разницу между ">" и ">>" знаю, но вот в случае iptables есть проблемы связанные с тем порядком правил, а также с исходным состояние файла iptables.

